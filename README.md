# HDMC: Hierarchical Distribution Matching and Cantrastive learning
Code and data for using HDMC, a novel deep learning based framework for batch effect removal in scRNA-seq data. 

## Dependencies
* Python 3.7.7
* scikit-learn 0.23.2
* pytorch 1.3.1
* imbalanced-learn 0.7.0
* rpy2 2.9.4
* universal-divergence 0.2.0

## Usage
* **run_simulate.py:**&nbsp; script for combining two simulated datasets generated by the splatter package, corresponding to the first experiment in the paper.
* **run_pancreas.py:** script for combining two pancreas datasets, corresponding to the second experiment.
* **run_pbmc.py:**&emsp; &nbsp;   script for combing two PBMC datasets, corresponding to the third experiment.
* **run_multi.py:**&emsp; &ensp;&nbsp;   script for combining multiple datasets, corresponding to the fourth experiment.
* **R:** &emsp;&emsp;&emsp; &emsp; &emsp;&emsp; &nbsp;     a folder containing some R scripts for data preprocessing, computing cluster similarities and generating simulated data. Refer to instructions.md                    in the folder for detailed information.
